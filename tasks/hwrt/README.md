# Аппаратная трассировка лучей

В данном задании нам предстоит поиграться с тем самым RTX.

## Перед началом

 1. Скопируйте в данную папку какую-нибудь рендерилку.
 2. Убедитесь, что ваш ПК поддерживает аппаратную трассировку лучей:
    - `VK_KHR_deferred_host_operations`,
    - `VK_KHR_acceleration_structure`,
    - `VK_KHR_ray_query`,
    - `SPV_KHR_ray_query`,
    - `GLSL_EXT_ray_query`.
 3. Убедитесь, что вы морально готовы расковыривать кишки Этны.

## Задание

#### Шаг 1

Затолкайте вашу сцену в ускоряющую структуру.
Достаточно будет лишь статических мешей.
Террейн, партиклы и воду лучше пока не трогать.

#### Шаг 2

Реализуйте упрощённую версию отражений при помощи инлайн рейтрейсинга.
 1. Используйте компьют-шейдер чтобы вычислить список тайлов экрана 16х16 в которых есть отражающие поверхности.
 2. Используйте отдельный компьют-шейдер и инлайн-рейтрейсинг чтобы запустить луч(и) для каждого пикселя каждого тайла.
 3. Останавливайте лучи после одного переотражения и рассчитывайте цвет отражения по Ламберту.
 Не забудьте использовать кубмапу неба если луч никуда не попал.
 4. Цвет отражений записывайте в отдельный storage image.
 5. Вмешивайте отражения в основную картинку в момент резолва G-буфера, либо в отдельном шейдере.

Получить красивую картинку с данной схемой вряд ли получится, цель &mdash; сделать чтобы хотя бы работало.
Не стесняйтесь создавать и использовать различные инструменты для отладки.
Если вы ещё их не освоили, освойте шейдерные принты.

## Бонусный уровень

Попытайтесь сделать чтобы всё таки было красиво: прикрутите библиотеку [NRD](https://github.com/NVIDIA-RTX/NRD).

## Полезные материалы

 1. https://github.com/KhronosGroup/Vulkan-Samples/tree/main/samples/extensions/ray_queries &mdash; пример использования инлайн-рейтрейсинга в Вулкане
 2. https://github.com/NVIDIA-RTX/NRD &mdash; библиотека для денойзинга от Nvidia
 3. https://developer.nvidia.com/nsight-graphics &mdash; nsight, дебаггер графики способный работать с рейтрейсингом вулкана, но только на Windows и с GPU от Nvidia